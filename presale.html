<!DOCTYPE html >
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="icon" href="assets/images/title.png" type="image/png" sizes="16x16">
<title>mobipromo</title>
<meta name="keywords" content="" />
<meta name="description" content="" />
<link rel="stylesheet" href="assets/css/login.css" />
<style>
	.presale-container {
		margin-top: 10%;
	}

</style>
<body>

<div class="presale-container">
	<h1>订单表单信息</h1>
	
	<div class="connect">
		<p>www.mobipromo.io</p>
	</div>
	<div>
		<input type="text" name="device_name" class="device_name" placeholder="设备名称"/>
	</div>
	<div>
		<input type="text" name="username" class="username" placeholder="姓名"/>
	</div>
	<div>
		<input type="text" name="phone_number" class="phone_number" placeholder="电话"/>
	</div>
	<div>
		<input type="text" name="mailbox" class="mailbox" placeholder="邮箱"/>
	</div>
	<div>
		<input type="text" name="zip_code" class="zip_code" placeholder="邮编"/>
	</div>
	<div>
		<input type="text" name="address" class="address" placeholder="收件地址"/>
	</div>
	<div style="position: relative;">
		<input type="text" name="buyAmount" class="buyAmount" placeholder="购买数量不大于3台"/>
	<button id='jiage' style='width: 50px; height: 50px; display: block; position: absolute; left: 62%; top: 0;'></button>
	</div>
	<button id="submit" type="submit">确认提交</button>
</div>
<style>
		.pay_btn {
			overflow: hidden;
			top: 15px;
		}
		.pay_btn div{
			float: left;	
			width: 136px;
			height: 50px;
			line-height: 50px;
			font-size: 16px;
			border: 1px solid #ffffff;
			border-radius: 7px;
			cursor: pointer;
		}
		.pay_btn div:nth-child(1) {
			margin-right: 23px;
		}
		.qr_code {
			width: 100%;
			height: 100%;
			overflow: hidden;
			position: absolute;
			top: -20%;
			padding-top: 350px;
			background: #ffffff;
			display: none;
		}
		.qr_code h1 {
			font-size: 30px;
			color: #666666;
		}
		.qr_code h2 {
			font-size: 18px;
			color: #666666;
		}
		.delate {
			font-size: 26px;
			color: red;
			position: relative;
			left: 20%;
			top: -34%;
			cursor: pointer;
		}
		body {
			position: relative;
		}
</style>
<button class="pay" style='background: none; display: none;'>
<div class="pay_btn">
	<div class='wechat'>微信支付</div>
	<div class='alipay'>支付宝支付</div>
</div>
</button>
<div class='qr_code qr_wechat'>
	<span class="delate">X</span>
	<h1>微信付款</h1>
	<img src="assets/images/footer_qr.png" width='200px;' height='200px;' alt="">
	<h2>1000元</h2>
</div>
<div class='qr_code qr_alipay'>
	<h1>支付宝付款</h1>
	<span class="delate">X</span>
	<img src="assets/images/footer_qr.png" width='200px;' height='200px;' alt="">
	<h2>1000元</h2>
</div>
<style>
	.list {
		overflow: hidden;
		width: 100%;
		padding-left: 30%;
		margin-top: 20px;
		margin-bottom: 40px;
	}
	.list ul {
		list-style: none;
		float: left;
	}
	.list ul li{
		border: 1px solid #ffffff;
		padding: 0 10px;
		height: 50px;
		line-height: 50px;
		font-size: 16px;
	}

</style>
<div class='list'>
	<ul class='listone'>
		<li>设备名称</li>
	</ul>
	<ul class='listtwo'>
		<li>用户名</li>
	</ul>
	<ul class='list_buyAmount'>
		<li>数量</li>
	</ul>
	<ul class='list_adree'>
		<li>收件地址</li>
	</ul>
	<ul class='list_phone'>
		<li>联系电话</li>
	</ul>
</div>
<script src="assets/js/jquery.min.js"></script>
<!-- <script src="assets/js/common.js"></script> -->
<!--背景图片自动更换-->
<script src="assets/js/supersized.3.2.7.min.js"></script>
<script src="assets/js/supersized-init.js"></script>
<!--表单验证-->
<!-- <script src="assets/js/jquery.validate.min.js?var1.14.0"></script> -->
<script>
$("#submit").click( function() {
		console.log('hello')
		$(".pay").css({
			"display": 'inline-block'
		})
	})
$(".wechat").click(function() {
	$(".qr_wechat").css({
		'display':'block',
	});
})
$(".alipay").click(function() {
	$(".qr_alipay").css({
		'display':'block',
	});
})
$(".delate").click( function() {
	console.log('hello')
	$(this).parent().css({
		"display": 'none'
	})
})
function getCookieValue(name){  /**获取cookie的值，根据cookie的键获取值**/  
    //用处理字符串的方式查找到key对应value  
    var name = escape(name);  
    //读cookie属性，这将返回文档的所有cookie  
    var allcookies = document.cookie;         
    //查找名为name的cookie的开始位置  
    name += "=";  
    var pos = allcookies.indexOf(name);      
    //如果找到了具有该名字的cookie，那么提取并使用它的值  
    if (pos != -1){                                             //如果pos值为-1则说明搜索"version="失败  
        var start = pos + name.length;                  //cookie值开始的位置  
        var end = allcookies.indexOf(";",start);        //从cookie值开始的位置起搜索第一个";"的位置,即cookie值结尾的位置  
        if (end == -1) end = allcookies.length;        //如果end值为-1说明cookie列表里只有一个cookie  
        var value = allcookies.substring(start,end); //提取cookie的值  
        return (value);                           //对它解码        
    }else{  //搜索失败，返回空字符串  
        return "";  
    }  
} 
var x = getCookieValue('Authorization');
console.log(x);
$("input[name='buyAmount']").blur(function () {
		$("#jiage")[0].innerHTML = 800 * $("input[name='buyAmount']").val();
})
	$("#submit").click(function () {
		var datalogin = {
			boxName: $("input[name='device_name']").val(),
			userName: $("input[name='username']").val(),
			userTel: $("input[name='phone_number']").val(),
			userEmail: $("input[name='mailbox']").val(),
			userZipCode: $("input[name='zip_code']").val(),
			receivingAddress: $("input[name='address']").val(),
			buyAmount: $("input[name='buyAmount']").val() * 1
		}
		console.log(typeof datalogin.buyAmount)
		$.ajax({
			headers: {
		          Accept: "application/json; charset=utf-8",
		    	  Authorization: 'Bearer' + ' ' + x
		      },
			url: '/promo/authed/account/post/sell/msg',
			data: JSON.stringify(datalogin),
			type: 'POST',
			contentType: "application/json; charset=utf-8",
			success: function (data) {
				console.log(data);
				$.ajax({
					headers: {
					          Accept: "application/json; charset=utf-8",
					    	  Authorization: 'Bearer' + ' ' + x
					      },
					type: 'GET',
					contentType: "application/json; charset=utf-8",
					url: '/promo/authed/account/get/selllist',
					success: function (data) {
						console.log(data.data);
						var data = data.data;
						var listone = '';
						var listtwo = '';
						var list_buyAmount = '';
						var list_adree = '';
						var list_phone = '';
						for(var i=0; i< data.length;i++) {
							listone += '<li>' + data[i].boxName + '</li>';
							listtwo += '<li>' + data[i].userName + '</li>';
							list_buyAmount += '<li>' + data[i].buyAmount + '</li>';
							list_adree += '<li>' + data[i].receivingAddress + '</li>';
							list_phone += '<li>' + data[i].userTel + '</li>';
						}
						$(".listone").append(listone);
						$(".listtwo").append(listtwo);
						$('.list_buyAmount').append(list_buyAmount);
						$('.list_adree').append(list_adree);
						$(".list_phone").append(list_phone);
					}
				})
			},
			error: function (data) {
				console.log(data)
			}
		})
	});

	$.ajax({
		headers: {
		          Accept: "application/json; charset=utf-8",
		    	  Authorization: 'Bearer' + ' ' + x
		      },
		type: 'GET',
		contentType: "application/json; charset=utf-8",
		url: '/promo/authed/account/get/selllist',
		success: function (data) {
			console.log(data.data);
			var data = data.data;
			var listone = '';
			var listtwo = '';
			var list_buyAmount = '';
			var list_adree = '';
			var list_phone = '';
			for(var i=0; i< data.length;i++) {
				listone += '<li>' + data[i].boxName + '</li>';
				listtwo += '<li>' + data[i].userName + '</li>';
				list_buyAmount += '<li>' + data[i].buyAmount + '</li>';
				list_adree += '<li>' + data[i].receivingAddress + '</li>';
				list_phone += '<li>' + data[i].userTel + '</li>';
			}
			$(".listone").append(listone);
			$(".listtwo").append(listtwo);
			$('.list_buyAmount').append(list_buyAmount);
			$('.list_adree').append(list_adree);
			$(".list_phone").append(list_phone);
		}
	})

</script>
</body>
</html>